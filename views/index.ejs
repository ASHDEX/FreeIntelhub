<%- include('partials/head') %>

<section class="hero">
  <h1>Cybersecurity Threat Intelligence</h1>
  <p>Real-time aggregated security news from <%= totalCount %> articles across trusted sources</p>
  <div class="search-box">
    <form action="/search" method="GET" autocomplete="off">
      <div class="search-wrapper">
        <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
        <input type="text" id="hero-search" name="q" placeholder="Search threats, vendors, CVEs..." value="">
        <kbd class="search-hint">/</kbd>
      </div>
    </form>
    <div class="suggestions" id="suggestions"></div>
  </div>
</section>

<section class="stats-row">
  <% categories.slice(0, 6).forEach(function(c) { %>
    <a href="/category/<%= encodeURIComponent(c.category) %>" class="stat-card">
      <strong><%= c.count %></strong>
      <span><%= c.category %></span>
    </a>
  <% }); %>
</section>

<% if (vendors.length > 0) { %>
<section class="vendor-bar">
  <h2>Trending Vendors</h2>
  <div class="vendor-tags">
    <% vendors.slice(0, 15).forEach(function(v) { %>
      <a href="/vendor/<%= encodeURIComponent(v.vendor) %>" class="badge badge-vendor"><%= v.vendor %> (<%= v.count %>)</a>
    <% }); %>
  </div>
</section>
<% } %>

<div class="two-col">
  <section class="col-main">
    <h2>Latest News</h2>
    <%- include('partials/articleList', { articles }) %>
    <% if (newsPages > 1) { %>
    <nav class="pagination">
      <% if (newsPage > 1) { %><a href="/?news=<%= newsPage - 1 %><%= typeof breachPage !== 'undefined' && breachPage > 1 ? '&breaches=' + breachPage : '' %>" class="page-btn">&laquo; Prev</a><% } %>
      <% for (var i = 1; i <= newsPages; i++) { %>
        <% if (i === newsPage) { %><span class="page-num active"><%= i %></span>
        <% } else if (i === 1 || i === newsPages || (i >= newsPage - 2 && i <= newsPage + 2)) { %><a href="/?news=<%= i %><%= typeof breachPage !== 'undefined' && breachPage > 1 ? '&breaches=' + breachPage : '' %>" class="page-num"><%= i %></a>
        <% } else if (i === newsPage - 3 || i === newsPage + 3) { %><span class="page-dots">...</span><% } %>
      <% } %>
      <% if (newsPage < newsPages) { %><a href="/?news=<%= newsPage + 1 %><%= typeof breachPage !== 'undefined' && breachPage > 1 ? '&breaches=' + breachPage : '' %>" class="page-btn">Next &raquo;</a><% } %>
    </nav>
    <% } %>
  </section>

  <section class="col-side">
    <h2>Data Breaches</h2>
    <%- include('partials/articleList', { articles: breachArticles }) %>
    <% if (breachPages > 1) { %>
    <nav class="pagination">
      <% if (breachPage > 1) { %><a href="/?breaches=<%= breachPage - 1 %><%= typeof newsPage !== 'undefined' && newsPage > 1 ? '&news=' + newsPage : '' %>" class="page-btn">&laquo; Prev</a><% } %>
      <% for (var i = 1; i <= breachPages; i++) { %>
        <% if (i === breachPage) { %><span class="page-num active"><%= i %></span>
        <% } else if (i === 1 || i === breachPages || (i >= breachPage - 2 && i <= breachPage + 2)) { %><a href="/?breaches=<%= i %><%= typeof newsPage !== 'undefined' && newsPage > 1 ? '&news=' + newsPage : '' %>" class="page-num"><%= i %></a>
        <% } else if (i === breachPage - 3 || i === breachPage + 3) { %><span class="page-dots">...</span><% } %>
      <% } %>
      <% if (breachPage < breachPages) { %><a href="/?breaches=<%= breachPage + 1 %><%= typeof newsPage !== 'undefined' && newsPage > 1 ? '&news=' + newsPage : '' %>" class="page-btn">Next &raquo;</a><% } %>
    </nav>
    <% } %>
  </section>
</div>

<%- include('partials/footer') %>
